<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="css/bootstrap-337.min.css" rel="stylesheet">
    <link href="css/font-awesome.min.css" rel="stylesheet">
<!--     <link href="css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css"> -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <link href="http://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet"
        id="bootstrap-css">
    <link href="css/style.css" rel="stylesheet">

</head>

<body style="padding: 0; margin: 0;">

    <!------ Include the above in your HEAD tag ---------->


    <div class="container" style="padding-top: 0; margin: 0;">

        <div class="price-box" style="padding-top: 0; margin-top: 0; width: 250px;">

            <form class="" role="form" style="padding-top: 0; margin-top: 0; width: 250px;">

                <div class="price-slider" style="margin-bottom: 10px;">
                    <h5 class="great" id="label-z">Harga Properti</h5>
                    <!-- <span></span> -->
                    <!-- <div class="col-sm-12"> -->
                    <!-- <div> -->
                    <input type="text" class="form-control" aria-label="harga_rumah" aria-describedby="basic-addon1"
                        style="font-size : 13px;  padding: 0; margin-top:10px ; width: 220px; height: 20px;"
                        id="harga_rumah">
                    <!-- </div> -->
                    <!-- </div> -->
                </div>

                <div class="price-slider">
                    <h5 class="great" id="label-z">Uang Muka</h5>
                    <span style="margin-bottom:20px ;">&nbsp;%</span>

                    <div class="col-sm-12">
                        <div id="slider"></div>
                    </div>
                </div>

                <div class="price-slider">
                    <h5 class="great" id="label-z">Jangka Waktu</h5>
                    <span style="margin-bottom:20px ;">&nbsp; Tahun</span>

                    <div class="col-sm-12">
                        <div id="slider2"></div>
                    </div>
                </div>


                <div class="price-slider">
                    <h5 class="great" id="label-z">Bagi Hasil</h5>
                    <span style="margin-bottom:20px ;">%</span>
                    <div class="col-sm-12">
                        <div id="slider3"></div>
                    </div>
                </div>

                <div class="">
                    <input type="hidden" id="harga_rumah" class="form-control">
                    <input type="hidden" id="uang_muka" class="form-control">
                    <input type="hidden" id="jangka_waktu" class="form-control">
                    <input type="hidden" id="bunga" class="form-control">
                </div>

                <div class="form-group" style="margin: 0;padding:0 ;">
                    <div class="price-slider" style="margin: 0;margin-right: 0;padding-right:0 ;">
                        <h5 class="great1" id="label-z">Hasil KPR :</h5>
                        <span style="margin-bottom:0px ;"></span>
                        <div class="col-sm-12">
                            <div id=""></div>
                        </div>
                    </div>
                    <div class="col text-" id="result">
                        <input type="hidden" id="total" class="form-control">
                        <p class="price lead text-center" id="total-label"
                            style="font-size:18px ; margin: 0; padding-left: 10px;"></p>
                        <br>

                    </div>
                    <div class="text-center">

                        <img src="img/logo.png" class="pt-4 mt-4" style="width:100px ;margin-top: 10px;margin-left: -20px;"
                            alt="">
                    </div>
                </div>
            </form>
        </div>

    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <script src="js/jquery.min.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    <script src="js/bootstrap.min.js"></script>

    <script src="js/jquery.js"></script>

    <script>
        /*!
    * jQuery UI Touch Punch 0.2.3
    *
    * Copyright 2011â€“2014, Dave Furfero
    * Dual licensed under the MIT or GPL Version 2 licenses.
    *
    * Depends:
    *  jquery.ui.widget.js
    *  jquery.ui.mouse.js
    */
        (function ($) {

            // Detect touch support
            $.support.touch = 'ontouchend' in document;

            // Ignore browsers without touch support
            if (!$.support.touch) {
                return;
            }

            var mouseProto = $.ui.mouse.prototype,
                _mouseInit = mouseProto._mouseInit,
                _mouseDestroy = mouseProto._mouseDestroy,
                touchHandled;

            /**
             * Simulate a mouse event based on a corresponding touch event
             * @param {Object} event A touch event
             * @param {String} simulatedType The corresponding mouse event
             */
            function simulateMouseEvent(event, simulatedType) {

                // Ignore multi-touch events
                if (event.originalEvent.touches.length > 1) {
                    return;
                }

                event.preventDefault();

                var touch = event.originalEvent.changedTouches[0],
                    simulatedEvent = document.createEvent('MouseEvents');

                // Initialize the simulated mouse event using the touch event's coordinates
                simulatedEvent.initMouseEvent(
                    simulatedType,    // type
                    true,             // bubbles                    
                    true,             // cancelable                 
                    window,           // view                       
                    1,                // detail                     
                    touch.screenX,    // screenX                    
                    touch.screenY,    // screenY                    
                    touch.clientX,    // clientX                    
                    touch.clientY,    // clientY                    
                    false,            // ctrlKey                    
                    false,            // altKey                     
                    false,            // shiftKey                   
                    false,            // metaKey                    
                    0,                // button                     
                    null              // relatedTarget              
                );

                // Dispatch the simulated event to the target element
                event.target.dispatchEvent(simulatedEvent);
            }

            /**
             * Handle the jQuery UI widget's touchstart events
             * @param {Object} event The widget element's touchstart event
             */
            mouseProto._touchStart = function (event) {

                var self = this;

                // Ignore the event if another widget is already being handled
                if (touchHandled || !self._mouseCapture(event.originalEvent.changedTouches[0])) {
                    return;
                }

                // Set the flag to prevent other widgets from inheriting the touch event
                touchHandled = true;

                // Track movement to determine if interaction was a click
                self._touchMoved = false;

                // Simulate the mouseover event
                simulateMouseEvent(event, 'mouseover');

                // Simulate the mousemove event
                simulateMouseEvent(event, 'mousemove');

                // Simulate the mousedown event
                simulateMouseEvent(event, 'mousedown');
            };

            /**
             * Handle the jQuery UI widget's touchmove events
             * @param {Object} event The document's touchmove event
             */
            mouseProto._touchMove = function (event) {

                // Ignore event if not handled
                if (!touchHandled) {
                    return;
                }

                // Interaction was not a click
                this._touchMoved = true;

                // Simulate the mousemove event
                simulateMouseEvent(event, 'mousemove');
            };

            /**
             * Handle the jQuery UI widget's touchend events
             * @param {Object} event The document's touchend event
             */
            mouseProto._touchEnd = function (event) {

                // Ignore event if not handled
                if (!touchHandled) {
                    return;
                }

                // Simulate the mouseup event
                simulateMouseEvent(event, 'mouseup');

                // Simulate the mouseout event
                simulateMouseEvent(event, 'mouseout');

                // If the touch interaction did not move, it should trigger a click
                if (!this._touchMoved) {

                    // Simulate the click event
                    simulateMouseEvent(event, 'click');
                }

                // Unset the flag to allow other widgets to inherit the touch event
                touchHandled = false;
            };

            /**
             * A duck punch of the $.ui.mouse _mouseInit method to support touch events.
             * This method extends the widget with bound touch event handlers that
             * translate touch events to mouse events and pass them to the widget's
             * original mouse event handling methods.
             */
            mouseProto._mouseInit = function () {

                var self = this;

                // Delegate the touch handlers to the widget's element
                self.element.bind({
                    touchstart: $.proxy(self, '_touchStart'),
                    touchmove: $.proxy(self, '_touchMove'),
                    touchend: $.proxy(self, '_touchEnd')
                });

                // Call the original $.ui.mouse init method
                _mouseInit.call(self);
            };

            /**
             * Remove the touch event handlers
             */
            mouseProto._mouseDestroy = function () {

                var self = this;

                // Delegate the touch handlers to the widget's element
                self.element.unbind({
                    touchstart: $.proxy(self, '_touchStart'),
                    touchmove: $.proxy(self, '_touchMove'),
                    touchend: $.proxy(self, '_touchEnd')
                });

                // Call the original $.ui.mouse destroy method
                _mouseDestroy.call(self);
            };

        })(jQuery);

    </script>

    <script>
        var rupiah = document.getElementById('harga_rumah');
        rupiah.addEventListener('keyup', function (e) {
            rupiah.value = formatRupiah(this.value, 'Rp ');
        })

        function formatRupiah(angka, prefix) {
            var number_string = angka.replace(/[^,\d]/g, '').toString(),
                split = number_string.split(','),
                sisa = split[0].length % 3,
                rupiah = split[0].substr(0, sisa),
                ribuan = split[0].substr(sisa).match(/\d{3}/gi);

            if (ribuan) {
                separator = sisa ? '.' : '';
                rupiah += separator + ribuan.join('.');
            }

            rupiah = split[1] != undefined ? rupiah + ',' + split[1] : rupiah;
            return prefix == undefined ? rupiah : (rupiah ? 'Rp ' + rupiah : '');
        }
    </script>
    
    <script>
    $(document).ready(function () {
    $("#slider").slider({
        animate: true,
        value: 20,
        min: 0,
        max: 50,
        step: 1,
        slide: function (event, ui) {
            update(1, ui.value); //changed
        }
    });

    $("#slider2").slider({
        animate: true,
        value: 10,
        min: 1,
        max: 20,
        step: 1,
        slide: function (event, ui) {
            update(2, ui.value); //changed
        }
    });

    $("#slider3").slider({
        animate: true,
        value: 10,
        min: 1,
        max: 30,
        step: 0.1,
        slide: function (event, ui) {
            update(3, ui.value); //changed
        }
    });

    //Added, set initial value.
    var $placeholder = "Rp 100.000.000"

    $("#harga_rumah").val();
    $("#uang_muka").val(20);
    $("#jangka_waktu").val(10);
    $("#bunga").val(10);
    $("#uang_muka-label").text(0);
    $("#jangka_waktu-label").text(0);
    $("#bunga-label").text(0);

    var $harga_rumah = document.getElementById('harga_rumah');
    $harga_rumah.onkeyup = function () {
        update();
        $("#harga_rumah-label").text($("#harga_rumah").val());
    }


});

//changed. now with parameter
function update(slider, val) {
    //changed. Now, directly take value from ui.value. if not set (initial, will use current value.)
    // var $uang_muka = slider == 1 ? val : $("#uang_muka").val();


    var $fharga_rumah = $("#harga_rumah").val().replace(/[^0-9]/g, "");


    var $uang_muka = slider == 1 ? val : $("#uang_muka").val();
    var $jangka_waktu = slider == 2 ? val : $("#jangka_waktu").val();
    var $bunga = slider == 3 ? val : $("#bunga").val();

    /* commented
    $uang_muka = $( "#slider" ).slider( "value" );
    $jangka_waktu = $( "#slider2" ).slider( "value" );
     */


    var $fharga_dp = $fharga_rumah * $uang_muka / 100;
    var $fplafon = $fharga_rumah - $fharga_dp;
    var $fwaktu = $jangka_waktu * 12;
    var $fbunga = $bunga / 100;
    var $fhitung_angsuran = ($fplafon * $fbunga / 12) / (1 - (Math.pow((1 + ($fbunga / 12)), -$fwaktu)));
    var $fangsuran = Math.round($fhitung_angsuran).toLocaleString('En-Us');

    $total = "$" + ($uang_muka * $jangka_waktu);



    $("#uang_muka").val($uang_muka);
    $("#uang_muka-label").text($uang_muka);
    $("#jangka_waktu").val($jangka_waktu);
    $("#jangka_waktu-label").text($jangka_waktu);
    $("#bunga").val($bunga);
    $("#bunga-label").text($bunga);
    $("#total").val($total);
    // $("#total-label").text($total);
    // $("#total-label").text($fharga_dp);
    // $("#total-label2").text($fplafon);
    // $("#total-label3").text($fwaktu);
    // $("#total-label4").text($fhitung_angsuran);
    $("#total-label").text('Rp ' + $fangsuran.replace(/\,/g, '.') + ' /bulan');

//     $('#slider a').html('<label><span class="glyphicon glyphicon-chevron-left"></span> ' + $uang_muka + ' <span class="glyphicon glyphicon-chevron-right"></span></label>');
//     $('#slider2 a').html('<label><span class="glyphicon glyphicon-chevron-left"></span> ' + $jangka_waktu + ' <span class="glyphicon glyphicon-chevron-right"></span></label>');
//     $('#slider3 a').html('<label><span class="glyphicon glyphicon-chevron-left"></span> ' + $bunga + ' <span class="glyphicon glyphicon-chevron-right"></span></label>');
    
      $('#slider a').html('<label><i class=" fa fa-star" aria-hidden="true"></i>' + $uang_muka + ' <span class=""><i class="fa fa-chevron-right" aria-hidden="true"></i></span></label>');
    $('#slider2 a').html('<label><span class="glyphicon glyphicon-chevron-left"></span> ' + $jangka_waktu + ' <span class="glyphicon glyphicon-chevron-right"></span></label>');
    $('#slider3 a').html('<label><span class="glyphicon glyphicon-chevron-left"></span> ' + $bunga + ' <span class="glyphicon glyphicon-chevron-right"></span></label>');
}


    </script>

</body>

</html>
